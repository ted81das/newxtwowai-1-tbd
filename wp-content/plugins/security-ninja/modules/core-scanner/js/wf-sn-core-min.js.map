{"version":3,"names":["jQuery","document","ready","$","fixDialogClose","event","bind","target","id","dialog","renderSource","dialog_id","post","ajaxurl","action","filename","hash","_ajax_nonce","wf_sn_cs","nonce","response","err","html","text","source","snippet","ext","style","alert","window","location","reload","get_latest_update","forceupdate","show","slideUp","addClass","data","doupdate","removeClass","out","append","slideDown","last_scan","on","this","attr","title","file_path","file_hash","e","preventDefault","confirm","filehash","closest","fadeOut","remove","success","ajax","url","type","delete_all_nonce","error","dialogClass","modal","resizable","zIndex","width","height","hide","open","ui","close","autoOpen","closeOnEscape","datatype"],"sources":["wf-sn-core.js"],"sourcesContent":["/* globals jQuery:true, ajaxurl:true, wf_sn_cs:true */\r\n/* globals: dialog_id */\r\n/*\r\n* Security Ninja - Scheduled Scanner add-on\r\n* (c) 2014. Web factory Ltd\r\n*/\r\n\r\njQuery( document ).ready( function( $ ) {\r\n  \r\n  \r\n  // get the updates\r\n  get_latest_update();\r\n  \r\n  \r\n  \r\n  /**\r\n  * fixDialogClose.\r\n  *\r\n  * @author\tLars Koudal\r\n  * @since\tv0.0.1\r\n  * @version\tv1.0.0\tFriday, December 18th, 2020.\r\n  * @global\r\n  * @param\tmixed\tevent\t\r\n  * @return\tvoid\r\n  */\r\n  function fixDialogClose( event ) {\r\n    jQuery('.ui-widget-overlay').bind('click', function(){ jQuery('#' + event.target.id).dialog('close'); });\r\n  }\r\n  \r\n  \r\n  /**\r\n  * renderSource.\r\n  *\r\n  * @author\tLars Koudal\r\n  * @since\tv0.0.1\r\n  * @version\tv1.0.0\tFriday, December 18th, 2020.\r\n  * @global\r\n  * @param\tmixed\tevent\t\r\n  * @return\tvoid\r\n  */\r\n  function renderSource( event ) {\r\n    var dialog_id = '#' + event.target.id;\r\n    \r\n    jQuery.post(ajaxurl, {\r\n      action: 'sn_core_get_file_source',\r\n      filename: jQuery('#source-dialog').dialog('option', 'file_path'),\r\n      hash: jQuery('#source-dialog').dialog('option', 'file_hash'),\r\n      _ajax_nonce: wf_sn_cs.nonce\r\n      \r\n    }, function(response) {\r\n      if (response) {\r\n        if (response.err) {\r\n          jQuery(dialog_id).html('<p><b>An error occured.</b> ' + response.err + '</p>'); // @i8n\r\n        } else {\r\n          jQuery(dialog_id).html('<pre class=\"sn-core-source\"></pre>');\r\n          jQuery('pre', dialog_id).text(response.source);\r\n          jQuery('pre', dialog_id).snippet(response.ext, {style: 'whitengrey'});\r\n        }\r\n      } else {\r\n        alert('An undocumented error occured. The page will reload.'); // @i8n\r\n        window.location.reload();\r\n      }\r\n    }, 'json');\r\n  }\r\n  \r\n  \r\n  \r\n  \r\n\r\n  $('button.sn-show-source').on(\"click\",function() {\r\n    $($(this).attr('href')).dialog('option', {\r\n      title: 'File source: ' + $(this).attr('data-file'), // @i8n\r\n      file_path: $(this).attr('data-file'),\r\n      file_hash: $(this).attr('data-hash')\r\n    }).dialog('open');\r\n    return false;\r\n  });\r\n  \r\n  \r\n  \r\n  // Restore a file\r\n  $(document).on('click', 'button.sn-restore-source', function(e) {\r\n    e.preventDefault();\r\n    if (!confirm('Are you sure you want to restore this file?')) { // @i8n\r\n      return false;\r\n    }\r\n    jQuery(this).attr('disabled', 'disabled');\r\n    var filename = jQuery(this).attr('data-file');\r\n    var filehash = jQuery(this).attr('data-hash');\r\n    jQuery.post(ajaxurl, {\r\n      action      : 'sn_core_restore_file_do',\r\n      _ajax_nonce : wf_sn_cs.nonce,\r\n      filename: filename,\r\n      filehash: filehash\r\n    }, function(response) {\r\n      if (response == '1') {\r\n        jQuery('[data-hash=\"'+filehash+'\"]').closest('li').fadeOut( \"slow\", function() {\r\n          jQuery(this).remove();\r\n        });\r\n      } \r\n      else {\r\n        alert('An error occured - ' + response); // @i8n\r\n        jQuery(this).attr('disabled', '');\r\n      }\r\n    }, 'json');\r\n    \r\n  });\r\n  \r\n  \r\n  \r\n  // Delete a file\r\n  $(document).on('click', 'button.sn-delete-source', function(e) {\r\n    e.preventDefault();\r\n    if (!confirm('Are you sure you want to delete this file?')) { // @i8n\r\n      return false;\r\n    }\r\n    jQuery(this).attr('disabled', 'disabled');\r\n    var filename = jQuery(this).attr('data-file');\r\n    var filehash = jQuery(this).attr('data-hash');\r\n    jQuery.post(ajaxurl, {\r\n      action      : 'sn_core_delete_file_do',\r\n      _ajax_nonce : wf_sn_cs.nonce,\r\n      filename: filename,\r\n      filehash: filehash\r\n    }, function(response) {\r\n      if ( response.success ) {\r\n        jQuery('[data-hash=\"'+filehash+'\"]').closest('li').fadeOut( \"slow\", function() {\r\n          jQuery(this).remove();\r\n        });\r\n      } \r\n      else {\r\n        alert('An error occured - ' + response); // @i8n\r\n        jQuery(this).attr('disabled', '');\r\n      }\r\n    }, 'json');\r\n  });\r\n  \r\n\r\n\r\n  \r\n  \r\n  // Delete ALL files\r\n  $(document).on('click', 'button.sn-delete-all-files', function(e) {\r\n    e.preventDefault();\r\n    if (!confirm('Are you sure you want to delete all unknown files?')) { // @i8n\r\n      return false;\r\n    }\r\n    jQuery(this).attr('disabled', 'disabled');\r\n\r\n    jQuery.ajax({\r\n      url: ajaxurl, // WP variable, contains URL pointing to admin-ajax.php\r\n      type: 'POST',\r\n      data: {\r\n      'action'      : 'sn_core_delete_all_unknowns',\r\n      '_ajax_nonce' : wf_sn_cs.delete_all_nonce\r\n    },\r\n    success: function(  ) {\r\n      window.location.reload();\r\n    },\r\n    error: function(  ) {\r\n      // Whooops, something went wrong!\r\n    }\r\n  });\r\n});\r\n  \r\n  $('#source-dialog').dialog(\r\n    {\r\n      'dialogClass': 'wp-dialog',\r\n      'modal': true,\r\n      'resizable': false,\r\n      'zIndex': 9999,\r\n      'width': 800,\r\n      'height': 550,\r\n      'hide': 'fade',\r\n      'open': function(event, ui) { renderSource(event, ui); fixDialogClose(event, ui); },\r\n      'close': function() { jQuery('#source-dialog').html('<p>Please wait.</p>'); }, // @i8n\r\n      'show': 'fade',\r\n      'autoOpen': false,\r\n      'closeOnEscape': true\r\n    }\r\n    );\r\n    \r\n    \r\n    /**\r\n    * get_latest_update.\r\n    *\r\n    * @author\tLars Koudal\r\n    * @since\tv0.0.1\r\n    * @version\tv1.0.0\tWednesday, December 30th, 2020.\r\n    * @global\r\n    * @param\tmixed\tforceupdate\t\r\n    * @return\tvoid\r\n    */\r\n    function get_latest_update( forceupdate ) {\r\n\r\n      jQuery( '#wf-sn-core-scanner-response' ).show();\r\n\r\n      jQuery( '#wf-sn-core-scanner-response #sn-cs-results' ).slideUp();\r\n      jQuery( '#wf-sn-core-scanner-response #last_scan').slideUp();\r\n      jQuery( '#wf-sn-core-scanner-response .spinner' ).addClass( 'is-active' );\r\n      var data = {\r\n        action: 'sn_core_run_scan',\r\n        _ajax_nonce: wf_sn_cs.nonce\r\n      };\r\n      if (forceupdate) {\r\n        data.doupdate = true;\r\n      }\r\n      $.post( ajaxurl, data, function( response ) {\r\n        jQuery( '#wf-sn-core-scanner-response .spinner' ).removeClass( 'is-active' );\r\n\r\n        if ( response.data.out ) {\r\n          jQuery( '#wf-sn-core-scanner-response' ).append( response.data.out ).slideDown();\r\n        }\r\n        if ( response.data.last_scan ) {\r\n          jQuery('#wf-sn-core-scanner-response #last_scan').html( response.data.last_scan ).slideDown();\r\n        }\r\n      }, 'json');\r\n    }\r\n    \r\n    \r\n    \r\n    \r\n    // Run AJAX core scan and display returned results\r\n    $( document ).on( 'click', '#sn-run-core-scan', function( e ) {\r\n      e.preventDefault();\r\n      jQuery( '#wf-sn-core-scanner-response #sn-cs-results' ).slideUp();\r\n      jQuery( '#wf-sn-core-scanner-response #last_scan').slideUp();\r\n      jQuery( '#wf-sn-core-scanner-response .spinner' ).addClass( 'is-active' );\r\n      jQuery.post(ajaxurl, {\r\n        action: 'sn_core_run_scan',\r\n        _ajax_nonce: wf_sn_cs.nonce,\r\n        datatype: 'json',\r\n        doupdate: true\r\n      }, function( response ) {\r\n        jQuery( '#wf-sn-core-scanner-response .spinner' ).removeClass( 'is-active' );\r\n        if ( response.data.out ) {\r\n          jQuery( '#wf-sn-core-scanner-response' ).append( response.data.out ).slideDown();\r\n        }\r\n        if ( response.data.last_scan ) {\r\n          jQuery('#wf-sn-core-scanner-response #last_scan').html( response.data.last_scan ).slideDown();\r\n        }\r\n      });\r\n    } );\r\n  });"],"mappings":"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"}