UAGBLogin={settings:{},loginButtonInnerElement:"",spinner:`<svg width="20" height="20" viewBox="0 0 38 38" xmlns="http://www.w3.org/2000/svg" stroke="#fff">
		<g fill="none" fill-rule="evenodd">
			<g transform="translate(1 1)" stroke-width="2">
				<circle stroke-opacity=".5" cx="18" cy="18" r="18"/>
				<path d="M36 18c0-9.94-8.06-18-18-18">
					<animateTransform
						attributeName="transform"
						type="rotate"
						from="0 18 18"
						to="360 18 18"
						dur="1s"
						repeatCount="indefinite"/>
				</path>
			</g>
		</g>
	</svg>`,classes:{inputError:"spectra-pro-login-form__input-error",fieldErrorMessage:"spectra-pro-login-form__field-error-message"},init(e,t,r={}){this._listenLogoutRedirect(r),this.settings[t]=r,this.getElements(e)&&(this.validateOnEntry(e,r?.this_field_error_msg),this.passwordVisibility(e,t),r.enableReCaptcha&&this.reCaptcha(t,r),this.formSubmitInit(e,t,r.enableReCaptcha,r.recaptchaVersion,r?.this_field_error_msg),this.forgotPasswordInit(e,t))},forgotPasswordInit(e,t){var r=document.querySelector(e+" .spectra-pro-login-form-forgot-password > a"),s=this.settings[t];const o=document.querySelector(t+" .spectra-pro-login-form-status"),a=UAGBLogin.getElements(e);let i=new FormData;i.append("action","spectra_pro_block_login_forgot_password");const n=this.processAjaxUrl(s.ajax_url);r?.addEventListener("click",function(){let e=UAGBLogin.serializeArrayJS(a);for(const t in e=e.reduce((e,{name:t,value:r})=>(e[t]=r,e),{}))i.append(t,e[t]);fetch(n,{method:"POST",credentials:"same-origin",body:i}).then(e=>e.json()).then(e=>{if(o){var t=document.createElement("div");if(e.success)t.classList.add("spectra-pro-login-form-status__success"),t.innerText=e.data,o.replaceChildren(t);else if("custom"===e.data.type)t.classList.add("spectra-pro-login-form-status__error"),t.innerText=e.data.message,o.replaceChildren(t);else{var r=[];if(e?.data&&"object"==typeof e.data&&0<Object.keys(e.data).length)for(const a of e.data){var s=document.createElement("div");s.classList.add("spectra-pro-login-form-status__error"),s.innerText=a.message,r.push(s)}r?o.replaceChildren(...r):(t.classList.add("spectra-pro-login-form-status__error"),t.innerText=JSON.stringify(e.data).replace(/\\"/g,"'"),o.replaceChildren(t))}}}).catch(e=>{})})},_validateFields(e,t){switch(e.name){case"username":""===e.value.trim()?this._setStatus(e,t.username,"error"):this._setStatus(e,null,"success");break;case"password":""===e.value.trim()?this._setStatus(e,t.password,"error"):this._setStatus(e,null,"success")}},_setStatus(e,t,r){var s=e.parentElement.querySelector(".spectra-pro-login-form__field-error-message");"success"===r&&(s&&s.remove(),e.classList.remove(UAGBLogin.classes.inputError)),"error"===r&&(e.classList.add(UAGBLogin.classes.inputError),s?s.innerHTML=t:((r=document.createElement("span")).classList="spectra-pro-login-form__field-error-message",r.innerHTML=t,e.parentElement.appendChild(r)))},_isFormSubmitable(e){return UAGBLogin.getElements(e).getElementsByClassName(UAGBLogin.classes.inputError).length<1},_showValidationMessage(e,t){const s=UAGBLogin.getElements(e);Object.entries(t).forEach(([e,t])=>{var r=document.createElement("span");r.classList="spectra-pro-login-form__field-error-message",r.innerHTML=t,s.querySelector('input[name="'+e+'"]')?.parentElement().append(r)})},_dispatchLoginRedirect(e){window.location.href=e.loginRedirectURL},_listenLogoutRedirect(e){var t=".uagb-block-"+e.block_id,t=document.querySelector(t+" .wp-block-spectra-pro-login__logged-in-message a"),r=this._sameOrigin(window.location,e.logoutRedirectURL);t&&!r&&t.addEventListener("click",()=>{window.open(e.logoutRedirectURL)})},_sameOrigin(e,t){e=new URL(e),t=new URL(t);return e.origin===t.origin},_formSubmit(n,e,t=!1){const c=this.settings[e],l=document.querySelector(e+" .spectra-pro-login-form-submit-button"),d=document.querySelector(e+" .spectra-pro-login-form-status"),p=UAGBLogin.getElements(n);let r=this.serializeArrayJS(p);r=r.reduce((e,{name:t,value:r})=>(e[t]=r,e),{}),c.enableReCaptcha&&(r.recaptchaStatus=c.enableReCaptcha,r.reCaptchaType=c.recaptchaVersion,t)&&(r["g-recaptcha-response"]=t);var s=new FormData;s.append("action","spectra_pro_block_login");for(const a in r)s.append(a,r[a]);p.style.opacity="0.45",l.setAttribute("disabled","disabled"),UAGBLogin.loginButtonInnerElement=l.innerHTML,l.innerHTML=UAGBLogin.spinner,d.innerHTML="";e=p.querySelector("."+UAGBLogin.classes.fieldErrorMessage),e&&e.remove(),t=this.processAjaxUrl(c.ajax_url);fetch(t,{method:"POST",credentials:"same-origin",body:s}).then(e=>e.json()).then(e=>{var t=document.createElement("div");if(e.success)t.classList.add("spectra-pro-login-form-status__success"),t.innerText=e.data,d.appendChild(t);else{var r=[];if(e?.data)if("object"==typeof e.data&&0<Object.keys(e.data).length)for(const i of e.data){var s=document.createElement("div");s.classList.add("spectra-pro-login-form-status__error"),s.innerText=i,r.push(s)}else if("string"==typeof e.data){var a=(new DOMParser).parseFromString(e.data,"text/html").body;!function t(e){if(e){r=e,Node.TEXT_NODE===r.nodeType||"body"===r?.tagName?.toLowerCase()||["strong","em","i","a","span"].includes(r.tagName.toLowerCase())||r.parentNode.removeChild(r);var r,s=e;if(Node.TEXT_NODE!==s.nodeType&&s?.attributes[0]){const a=["class","id","href"];Array.from(s.attributes).forEach(e=>{var t=e.name.toLowerCase();a.includes(t)?s.setAttribute(t,wp.escapeHtml.escapeAttribute(s.getAttribute(t))):s.removeAttribute(e.name)})}Array.from(e.childNodes).forEach(e=>{t(e)})}}(a);var o=document.createElement("div");o.classList.add("spectra-pro-login-form-status__error"),o.append(...a.childNodes),r.push(o)}r?d.replaceChildren(...r):(t.classList.add("spectra-pro-login-form-status__error"),t.innerText=JSON.stringify(e.data).replace(/\\"/g,"'"),d.replaceChildren(t))}setTimeout(()=>{p.style.opacity="1",l.innerHTML=UAGBLogin.loginButtonInnerElement,l.removeAttribute("disabled"),e.success?UAGBLogin._dispatchLoginRedirect(c):UAGBLogin._showValidationMessage(n,e.data)},1e3)}).catch(e=>{})},getElements(e,t=null){let r=document.querySelector(e);if(r){if(t)return r.querySelector(t)}else{var s=document.querySelector('iframe[name="editor-canvas"]');if(s&&s.contentDocument&&(r=s.contentDocument.querySelector(e),t))return r=r.querySelector(t)}return r},getFormFields(e){return UAGBLogin.getElements(e).querySelectorAll("input:not([type=hidden])")},validateOnEntry(e,t){const r=this;for(const s of this.getFormFields(e))s.addEventListener("focusout",()=>{r._validateFields(s,t)})},reCaptcha(e,t){var r;"v2"===t.recaptchaVersion&&UAGBLogin.settings[e].recaptchaSiteKey?((r=document.createElement("script")).type="text/javascript",r.src="https://www.google.com/recaptcha/api.js",document.head.appendChild(r)):"v3"===t.recaptchaVersion&&UAGBLogin.settings[e].recaptchaSiteKey&&((r=document.createElement("script")).type="text/javascript",r.src="https://www.google.com/recaptcha/api.js?render="+t.recaptchaSiteKey,document.head.appendChild(r))},formSubmitInit(r,s,a,o,i){const n=this.getFormFields(r);document.querySelector(r).addEventListener("submit",function(e){e.preventDefault();for(const t of n)UAGBLogin._validateFields(t,i);UAGBLogin._isFormSubmitable(r)&&(!0===a&&"v3"===o?grecaptcha.ready(function(){grecaptcha.execute(UAGBLogin.settings[s].recaptchaSiteKey,{action:"submit"}).then(function(e){UAGBLogin._formSubmit(r,s,e)})}):UAGBLogin._formSubmit(r,s))})},passwordVisibility(e,r){function t(e){var t=document.querySelector(r+" .spectra-pro-login-form-pass-wrap button");t.querySelector(".dashicons").classList.remove(e?"dashicons-hidden":"dashicons-visibility"),t.querySelector(".dashicons").classList.add(e?"dashicons-visibility":"dashicons-hidden")}UAGBLogin.getElements(e).querySelector("#password-visibility-"+UAGBLogin.settings[r].block_id).addEventListener("click",function(){var e=document.querySelector(r+" .spectra-pro-login-form-pass-wrap input");"password"===e.getAttribute("type")?(e.setAttribute("type","text"),t(!1)):(e.setAttribute("type","password"),t(!0))})},serializeArrayJS(e){let r=[];return Array.prototype.slice.call(e.elements).forEach(function(t){!t.name||t.disabled||-1<["file","reset","submit","button"].indexOf(t.type)||("select-multiple"===t.type?Array.prototype.slice.call(t.options).forEach(function(e){e.selected&&r.push({name:t.name,value:e.value})}):-1<["checkbox","radio"].indexOf(t.type)&&!t.checked||r.push({name:t.name,value:t.value}))}),r},processAjaxUrl(e){e=new URL(e);return e.protocol!==window.location.protocol&&(e.protocol=window.location.protocol),e}};