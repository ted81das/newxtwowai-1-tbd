UAGBRegister={settings:{},registerButtonInnerElement:"",spinner:`<svg width="20" height="20" viewBox="0 0 38 38" xmlns="http://www.w3.org/2000/svg" stroke="#fff">
		<g fill="none" fill-rule="evenodd">
			<g transform="translate(1 1)" stroke-width="2">
				<circle stroke-opacity=".5" cx="18" cy="18" r="18"/>
				<path d="M36 18c0-9.94-8.06-18-18-18">
					<animateTransform
						attributeName="transform"
						type="rotate"
						from="0 18 18"
						to="360 18 18"
						dur="1s"
						repeatCount="indefinite"/>
				</path>
			</g>
		</g>
	</svg>`,classes:{inputError:"spectra-pro-register-form__input-error",inputSuccess:"spectra-pro-register-form__input-success",fieldErrorMessage:"spectra-pro-register-form__field-error-message"},init(e,t,s={}){this.settings[t]=s,document.querySelector(e)&&(this.validateOnEntry(t,e),this.usernameAndEmailUniqueCheck(t,e),s.reCaptchaEnable&&this.reCaptcha(t,s.reCaptchaType),this.formSubmitInit(t,e,s.reCaptchaEnable,s.reCaptchaType))},_validateFields(e,t,s){var r=document.querySelector(t);if(s.required)switch(s.name){case"first_name":""===s.value.trim()?this._setStatus(s,`${s?.previousElementSibling?.innerText?s.previousElementSibling.innerText:uagb_register_js.first_name} `+uagb_register_js.cannot_be_blank,"error"):this._setStatus(s,null,"success");break;case"last_name":""===s.value.trim()?this._setStatus(s,`${s?.previousElementSibling?.innerText?s.previousElementSibling.innerText:uagb_register_js.last_name} `+uagb_register_js.cannot_be_blank,"error"):this._setStatus(s,null,"success");break;case"username":""===s.value.trim()&&this._setStatus(s,UAGBRegister.settings[e].messageInvalidUsernameError,"error");break;case"email":""===s.value.trim()?this._setStatus(s,UAGBRegister.settings[e].messageEmailMissingError,"error"):""!==s.value.trim()&&(/\S+@\S+\.\S+/.test(s.value)?this._setStatus(s,null,"success"):this._setStatus(s,UAGBRegister.settings[e].messageInvalidEmailError,"error"));break;case"password":""===s.value.trim()?this._setStatus(s,UAGBRegister.settings[e].messageInvalidPasswordError,"error"):this._setStatus(s,null,"success");break;case"reenter_password":var a=r.querySelector('input[name="password"]');a.value&&(s.value!==a.value||""===s.value.trim()?this._setStatus(s,UAGBRegister.settings[e].messagePasswordConfirmError,"error"):this._setStatus(s,null,"success"));break;case"terms":s.checked?this._setStatus(s,null,"success"):this._setStatus(s,UAGBRegister.settings[e].messageTermsError,"error");break;default:""!==!s.value?this._setStatus(s,UAGBRegister.settings[e].messageOtherError,"error"):this._setStatus(s,null,"success")}},_setStatus(e,t,s,r=null){var a,i=e.parentElement.querySelector(".spectra-pro-register-form__field-success-message"),n=e.parentElement.querySelector(".spectra-pro-register-form__field-error-message");"success"===s&&(n&&(e.classList.remove(UAGBRegister.classes.inputError),n.remove()),e.classList.add(UAGBRegister.classes.inputSuccess),i?(i.innerHTML=t,r&&(i.style.color=r)):((a=document.createElement("span")).classList="spectra-pro-register-form__field-success-message",a.innerHTML=t,r&&(a.style.color=r),e.parentElement.appendChild(a))),"error"===s&&(e.classList.add(UAGBRegister.classes.inputError),i&&(e.classList.remove(UAGBRegister.classes.inputSuccess),i.remove()),n?n.innerHTML=t:((r=document.createElement("span")).classList="spectra-pro-register-form__field-error-message",r.innerHTML=t,e.parentElement.appendChild(r)))},_isFormSubmittable(e){return document.querySelector(e).getElementsByClassName(UAGBRegister.classes.inputError).length<1},_debounce(t,s=500){let r;return(...e)=>{clearTimeout(r),r=setTimeout(()=>{t.apply(this,e)},s)}},_clearValidationMessage(e){e=document.querySelector(e);e.querySelector(".spectra-pro-register-form__field-error-message").remove(),e.querySelector(".spectra-pro-register-form-status").remove()},_showValidationMessage(e,t){const r=document.querySelector(e);Object.entries(t).forEach(([e,t])=>{var s=document.createElement("span"),t=(s.classList="spectra-pro-register-form__field-error-message",s.innerHTML=t,r.querySelector('input[name="'+e+'"]'));t&&t.parentElement.append(s)})},reCaptcha(e,t){var s;"v2"===t&&UAGBRegister.settings[e].recaptchaSiteKey?((s=document.createElement("script")).type="text/javascript",s.src="https://www.google.com/recaptcha/api.js",document.head.appendChild(s)):"v3"===t&&UAGBRegister.settings[e].recaptchaSiteKey&&(UAGBRegister.settings[e].hidereCaptchaBatch&&(s=document.getElementsByClassName("grecaptcha-badge")[0])&&(s.style.visibility="hidden"),(t=document.createElement("script")).type="text/javascript",t.src="https://www.google.com/recaptcha/api.js?render="+UAGBRegister.settings[e].recaptchaSiteKey,document.head.appendChild(t))},getFormFields(e){return document.querySelector(e).getElementsByTagName("input")},validateOnEntry(e,t){const s=this;for(const r of this.getFormFields(t))"password"===r.type&&"password"===r.name&&r.addEventListener("keyup",()=>{s._checkPasswordStrength(e,r)}),r.addEventListener("focusout",()=>{s._validateFields(e,t,r)})},_checkPasswordStrength(e,t){var s=t.value;let r;switch(r=UAGBRegister.settings[e].wp_version?wp.passwordStrength.meter(s,wp.passwordStrength.userInputDisallowedList(),s):wp.passwordStrength.meter(s,wp.passwordStrength.userInputBlacklist(),s)){case-1:this._setStatus(t,pwsL10n.unknown,"success","#cfcfcf");break;case 2:this._setStatus(t,pwsL10n.bad,"success","#e07757");break;case 3:this._setStatus(t,pwsL10n.good,"success","#f0ad4e");break;case 4:this._setStatus(t,pwsL10n.strong,"success","#5cb85c");break;case 5:this._setStatus(t,pwsL10n.mismatch,"success","#f0ad4e");break;default:this._setStatus(t,pwsL10n.short,"success","#d9534f")}},usernameAndEmailUniqueCheck(s,e){const r=document.querySelector(e),a=this.settings[s],i=this;e=this._debounce(t=>{var e;t.target.value&&((e=new FormData).append("action","spectra_pro_block_register_unique_username_and_email"),e.append("field_name",t.target.name),e.append("field_value",t.target.value),e.append("security",r.querySelector('input[name="_nonce"]').value),fetch(a.ajax_url,{method:"POST",credentials:"same-origin",body:e}).then(e=>e.json()).then(e=>{e.success&&("username"===t.target.name?i._setStatus(r.querySelector('input[name="username"]'),e.data?.has_error?UAGBRegister.settings[s][e.data?.attribute]:null,e.data?.has_error?"error":"success"):i._setStatus(r.querySelector('input[name="email"]'),e.data?.has_error?UAGBRegister.settings[s][e.data?.attribute]:null,e.data?.has_error?"error":"success"))}).catch(e=>{}))});r.querySelector('input[name="username"]')?.addEventListener("keypress",e,!1),r.querySelector('input[name="username"]')?.addEventListener("focusout",e,!1),r.querySelector('input[name="email"]').addEventListener("keypress",e,!1),r.querySelector('input[name="email"]').addEventListener("focusout",e,!1)},formSubmitInit(t,s,r,a){const i=document.querySelector(s);i.addEventListener("submit",e=>{if(e.preventDefault(),!0===r)if("v3"===a){if(0===document.getElementsByClassName("grecaptcha-logo").length)return!(i.parentElement.querySelector(".spectra-pro-register-form-status").innerHTML='<div class="spectra-pro-register-form-status__error"><strong>Error:</strong> Invalid Google reCAPTCHA Site Key.</div>');grecaptcha.ready(function(){grecaptcha.execute(UAGBRegister.settings[t].recaptchaSiteKey,{action:"submit"}).then(function(e){UAGBRegister.formSubmit(t,s,e)})})}else UAGBRegister.formSubmit(t,s);else UAGBRegister.formSubmit(t,s)})},_dispatchLoginRedirect(e){window.location.href=e},formSubmit(r,a,e=!1){var t=document.querySelector(a);if(UAGBRegister._isFormSubmittable(a)){const i=t.parentElement.querySelector(".spectra-pro-register-form-status");var s=new FormData;s.append("action","spectra_pro_block_register"),s.append("post_id",UAGBRegister.settings[r].post_id),s.append("block_id",UAGBRegister.settings[r].block_id);for(const n of t.elements)n.name&&s.append(n.name,n.value);e&&s.append("g-recaptcha-response",e),UAGBRegister._before_submit(a);e=t.querySelector("."+UAGBRegister.classes.fieldErrorMessage),t=(e&&e.remove(),UAGBRegister.processAjaxUrl(UAGBRegister.settings[r].ajax_url));fetch(t,{method:"POST",credentials:"same-origin",body:s}).then(e=>e.json()).then(e=>{var t=document.createElement("div");if(e.success)t.classList.add("spectra-pro-register-form-status__success"),t.innerText=e.data?.message,i.replaceChildren(t);else{const s=[];"object"==typeof e.data&&Object.entries(e.data).forEach(([,e])=>{var t=document.createElement("div");t.classList.add("spectra-pro-register-form-status__error-item"),t.innerText=e,s.push(t)}),s?i.replaceChildren(...s):(t.classList.add("spectra-pro-register-form-status__error"),t.innerText=JSON.stringify(e.data),i.replaceChildren(t))}setTimeout(()=>{UAGBRegister._after_submit(a),e.success?UAGBRegister.settings[r].afterRegisterActions?.includes("redirect")?UAGBRegister._dispatchLoginRedirect(e.data?.redirect_url):window.location.reload():UAGBRegister._showValidationMessage(a,e.data)},1e3)}).catch(e=>{})}},_before_submit(e){var e=document.querySelector(e),t=e.querySelector(".spectra-pro-register-form__submit");t.setAttribute("disabled","disabled"),t.querySelector("svg")||(UAGBRegister.registerButtonInnerElement=t.innerHTML),t.innerHTML=UAGBRegister.spinner,t.style.opacity="0.45",e.parentElement.querySelector(".spectra-pro-register-form-status").innerHTML=""},_after_submit(e){e=document.querySelector(e).querySelector(".spectra-pro-register-form__submit");e.removeAttribute("disabled"),e.innerHTML=UAGBRegister.registerButtonInnerElement,e.style.opacity="1"},processAjaxUrl(e){e=new URL(e);return e.protocol!==window.location.protocol&&(e.protocol=window.location.protocol),e}};