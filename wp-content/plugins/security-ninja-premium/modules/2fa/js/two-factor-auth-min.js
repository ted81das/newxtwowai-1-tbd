function generateQRCode(){jQuery("#generate-qr").prop("disabled",!0);var e=jQuery(".qr-code .spinner");e.addClass("is-active"),jQuery.ajax({url:two_factor_auth.ajaxurl,type:"POST",data:{action:"secnin_generate_qr_code",nonce:two_factor_auth.nonce,temp_token:two_factor_auth.temp_token,user_ip:two_factor_auth.user_ip,user_agent:two_factor_auth.user_agent},success:function(r){jQuery("#generate-qr").prop("disabled",!1),e.removeClass("is-active"),r.success?(jQuery("#qr-code-img-err").text(""),jQuery("#qr-code-img").attr("src",r.data.qr_code)):jQuery("#qr-code-img-err").html('<p class="errmsg">Error generating QR code. Please try again. Debug info: '+r.data.message+"</p>")},error:function(r,o,t){console.error("AJAX error:",o,t),jQuery("#generate-qr").prop("disabled",!1),e.removeClass("is-active"),jQuery("#qr-code-img-err").html('<p class="errmsg">Error generating QR code. Please check your internet connection and try again. Status: '+r.status+", Response Text: "+r.responseText+"</p>")}})}jQuery(document).ready((function($){var e=jQuery("#twofa-form-verify"),r=jQuery("#twofa-code"),o=jQuery("#verify-2fa");jQuery(".qr-code").length?(console.log("2FA Debug: Form found, generating QR code"),generateQRCode()):console.log("2FA Debug: Form not found"),r.on("input",(function(){var e=jQuery(this).val();e=(e=e.replace(/\D/g,"")).slice(0,6),jQuery(this).val(e),o.prop("disabled",6!==e.length)})),e.on("submit",(function(e){e.preventDefault();var t=r.val();console.log("2FA Debug: Form submitted with code:",t),jQuery("#twofa-verify-msg").html('<p class="okmsg">Checking code.</p>'),o.prop("disabled",!0),r.prop("disabled",!0),$.ajax({url:two_factor_auth.ajaxurl,type:"POST",data:{action:"secnin_verify_2fa_code",code:t,nonce:two_factor_auth.nonce,temp_token:two_factor_auth.temp_token,user_id:two_factor_auth.user_id,user_ip:two_factor_auth.user_ip,user_agent:two_factor_auth.user_agent},success:function(e){e.success?(jQuery("#twofa-verify-msg").html('<p class="okmsg">'+e.data.message+"</p>"),console.log("2FA Debug: Redirecting to",e.data.redir_to),setTimeout((function(){window.location.href=e.data.redir_to}),1e3)):(console.log("2FA Debug: AJAX response:",e),o.prop("disabled",!1),r.prop("disabled",!1),jQuery("#twofa-verify-msg").html('<p class="errmsg">'+e.data.message+"</p>"))},error:function(e){console.error("2FA Debug: AJAX error:",e),jQuery("#twofa-verify-msg").html('<p class="errmsg">Error verifying code. Please check your internet connection and try again. Status: '+e.status+", Response Text: "+e.responseText+"</p>"),o.prop("disabled",!1),r.prop("disabled",!1)}})}))}));