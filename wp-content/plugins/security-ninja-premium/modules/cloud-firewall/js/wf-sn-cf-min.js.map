{"version":3,"names":["jQuery","document","ready","$","toggleSubInputs","checkbox","subInputClass","is","removeClass","addClass","on","this","click","e","preventDefault","prop","trigger","parents","toggleClass","find","select2","multiple","dropdownAutoWidth","closeOnSelect","theme","sn_close_timeout","sn_close_timeout_count","hide","sn_block_ui","attr","ajax","type","url","ajaxurl","data","action","_ajax_nonce","wf_sn_cf","nonce","success","text","setInterval","val","clearInterval","removeAttr","error","alert","window","location","reload","email","html","wf_sn","sn_plugin_url","get","response","fail","remove","append","submit","ip","post"],"sources":["wf-sn-cf.js"],"sourcesContent":["/* globals jQuery:true, ajaxurl:true, wf_sn_cf:true, wf_sn:true, sn_block_ui:true, alert:true */\r\n/*\r\n* Security Ninja PRO\r\n* (c) 2018. Web factory Ltd\r\n*/\r\n\r\n\r\njQuery(document).ready(function ($) {\r\n\r\n\r\n\r\n\r\nfunction toggleSubInputs(checkbox, subInputClass) {\r\n    if (checkbox.is(':checked')) {\r\n        $(subInputClass).removeClass('sn-disabled');\r\n    } else {\r\n        $(subInputClass).addClass('sn-disabled');\r\n    }\r\n}\r\n\r\n$('#wf_sn_cf_protect_login_form').on('change', function() {\r\n    toggleSubInputs($(this), '.sn-protect-login-form-subinput');\r\n});\r\n\r\n$('#wf_sn_cf_trackvisits').on('change', function() {\r\n    toggleSubInputs($(this), '.sn-protect-track-visitors-subinput');\r\n});\r\n\r\n$('#wf_sn_cf_change_login_url').on('change', function() {\r\n  toggleSubInputs($(this), '.sn-change-login-subinput');\r\n});\r\n\r\n$('#wf_sn_cf2fa_enabled').on('change', function() {\r\n  toggleSubInputs($(this), '.sn-2fa-subinput');\r\n});\r\n\r\n\r\n// Initial check to set the correct state on page load\r\ntoggleSubInputs($('#wf_sn_cf_protect_login_form'), '.sn-protect-login-form-subinput');\r\ntoggleSubInputs($('#wf_sn_cf_trackvisits'), '.sn-protect-track-visitors-subinput');\r\ntoggleSubInputs($('#wf_sn_cf_change_login_url'), '.sn-change-login-subinput');\r\n\r\ntoggleSubInputs($('#wf_sn_cf2fa_enabled'), '.sn-2fa-subinput');\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n  // select all countries button\r\n  $('#select_all_countries').click(function (e) {\r\n    e.preventDefault();\r\n    $('#wf_sn_cf_blocked_countries option').prop('selected', true);\r\n    $('#wf_sn_cf_blocked_countries').trigger('change');\r\n  });\r\n\r\n  $('#select_no_countries').click(function (e) {\r\n    e.preventDefault();\r\n    $('#wf_sn_cf_blocked_countries option').prop('selected', false);\r\n    $('#wf_sn_cf_blocked_countries').trigger('change');\r\n  });\r\n\r\n  $('#sn_cf').on('click', '.testresults h3', function (e) {\r\n    e.preventDefault();\r\n    $(this).parents('.testresults').toggleClass('opened').find('table');\r\n  });\r\n\r\n  // Select2 on country dropdown\r\n  $('#wf_sn_cf_blocked_countries').select2({\r\n    multiple: true,\r\n    dropdownAutoWidth: true,\r\n    //   width: 'resolve'\r\n    closeOnSelect: false,\r\n    theme: 'classic'\r\n  });\r\n\r\n  $('#sn-enable-firewall-overlay').on('click', function (e) {\r\n    e.preventDefault();\r\n\r\n    var sn_close_timeout;\r\n    var sn_close_timeout_count = 3;\r\n    $('#abort-scan').hide();\r\n    $('.loader').hide();\r\n    sn_block_ui('#sn-cloud-firewall');\r\n    $('#sn-close-firewall').attr('disabled', 'disabled');\r\n\r\n    $.ajax({\r\n      type: 'POST',\r\n      url: ajaxurl,\r\n      data: {\r\n        action: 'sn_enable_firewall',\r\n        _ajax_nonce: wf_sn_cf.nonce\r\n      },\r\n      success: function () {\r\n        $('#sn-firewall-status').text('Success!');\r\n        sn_close_timeout = setInterval(function () {\r\n          if (sn_close_timeout_count === 0) {\r\n            $('#sn-close-firewall').val('Close');\r\n            clearInterval(sn_close_timeout);\r\n            $('#sn-close-firewall').removeAttr('disabled');\r\n          } else {\r\n            $('#sn-close-firewall').val('Close (' + sn_close_timeout_count + ')');\r\n          }\r\n          sn_close_timeout_count--;\r\n        }, 1000);\r\n      },\r\n      error: function () {\r\n        alert('Undocumented error. Page will automatically reload.');\r\n        window.location.reload();\r\n      }\r\n    });\r\n  });\r\n\r\n  /* Close button for firewall overlay */\r\n  $('#sn-close-firewall').on('click', function (e) {\r\n    e.preventDefault();\r\n    window.location.reload();\r\n  });\r\n\r\n  $('#sn-send-unlock-code').on('click', function (e) {\r\n    e.preventDefault();\r\n    var data = {\r\n      action: 'sn_send_unblock_email',\r\n      email: $('#sn-ublock-email').val(),\r\n      _ajax_nonce: wf_sn_cf.nonce\r\n    };\r\n\r\n\r\n    $('#sn-unblock-message').html('<img title=\"Loading ...\" src=\"' + wf_sn.sn_plugin_url + 'images/ajax-loader.gif\" alt=\"Loading...\">');\r\n    $('#sn-unblock-message').removeClass('sn-unblock-message-bad');\r\n    $('#sn-unblock-message').removeClass('sn-unblock-message-good');\r\n\r\n    $.get(ajaxurl, data, function (response) {\r\n      if (response !== '1') {\r\n        $('#sn-unblock-message').html('An error occured and the message could not be sent.');\r\n        $('#sn-unblock-message').addClass('sn-unblock-message-bad');\r\n      } else {\r\n        $('#sn-unblock-message').html('Email sent successfully.');\r\n        $('#sn-unblock-message').addClass('sn-unblock-message-good');\r\n\r\n      }\r\n    }, 'html').fail(function () {\r\n      $('#sn-unblock-message').html('An error occured. The email could not be sent.');\r\n      $('#sn-unblock-message').addClass('sn-unblock-message-bad');\r\n    });\r\n  }); // send unlock code\r\n\r\n  $('#sn-firewall-blacklist-clear').on('click', function (e) {\r\n    e.preventDefault();\r\n\r\n    var data = {\r\n      action: 'sn_clear_blacklist',\r\n      email: $('#sn-ublock-email').val(),\r\n      _ajax_nonce: wf_sn_cf.nonce\r\n    };\r\n\r\n\r\n    $('#sn-firewall-blacklist-clear').remove();\r\n    $('#sn-firewall-blacklist').append('<img title=\"Loading ...\" src=\"' + wf_sn.sn_plugin_url + 'images/ajax-loader.gif\" alt=\"Loading...\">');\r\n\r\n    $.get(ajaxurl, data, function (response) {\r\n      if (response !== '1') {\r\n        alert('Undocumented error. Page will automatically reload.');\r\n        window.location.reload();\r\n      } else {\r\n        alert('List has been cleared.');\r\n        $('#sn-firewall-blacklist').html('No locally banned IPs');\r\n      }\r\n    }, 'html').fail(function () {\r\n      alert('Undocumented error. Page will automatically reload.');\r\n      window.location.reload();\r\n    });\r\n  }); // send unlock code\r\n\r\n\r\n\r\n  // Disable firewall\r\n  $('#sn-disable-firewall').on('click', function () {\r\n    $('#wf_sn_cf_active').val(0);\r\n    $('#sn-firewall-settings-form').submit();\r\n  });\r\n\r\n\r\n\r\n  // Test IP\r\n  $('#wf-cf-do-test-ip').on('click', function (e) {\r\n    e.preventDefault();\r\n\r\n    var data = {\r\n      action: 'sn_test_ip',\r\n      ip: $('#wf-cf-ip-test').val(),\r\n      _ajax_nonce: wf_sn_cf.nonce\r\n    };\r\n\r\n\r\n\r\n    $.post(ajaxurl, data, function (response) {\r\n\r\n      if (response.data && response.success) {\r\n        alert(response.data);\r\n      } else {\r\n        alert('An undocumented error has occured. Page will automatically reload.');\r\n        window.location.reload();\r\n      }\r\n\r\n    }, 'json');\r\n\r\n  });\r\n});\r\n"],"mappings":"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","ignoreList":[]}