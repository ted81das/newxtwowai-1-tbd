"use strict";jQuery(document).ready((function($){function e(e,n){e.is(":checked")?$(n).removeClass("sn-disabled"):$(n).addClass("sn-disabled")}$("#wf_sn_cf_protect_login_form").on("change",(function(){e($(this),".sn-protect-login-form-subinput")})),$("#wf_sn_cf_trackvisits").on("change",(function(){e($(this),".sn-protect-track-visitors-subinput")})),$("#wf_sn_cf_change_login_url").on("change",(function(){e($(this),".sn-change-login-subinput")})),$("#wf_sn_cf2fa_enabled").on("change",(function(){e($(this),".sn-2fa-subinput")})),e($("#wf_sn_cf_protect_login_form"),".sn-protect-login-form-subinput"),e($("#wf_sn_cf_trackvisits"),".sn-protect-track-visitors-subinput"),e($("#wf_sn_cf_change_login_url"),".sn-change-login-subinput"),e($("#wf_sn_cf2fa_enabled"),".sn-2fa-subinput"),$("#select_all_countries").click((function(e){e.preventDefault(),$("#wf_sn_cf_blocked_countries option").prop("selected",!0),$("#wf_sn_cf_blocked_countries").trigger("change")})),$("#select_no_countries").click((function(e){e.preventDefault(),$("#wf_sn_cf_blocked_countries option").prop("selected",!1),$("#wf_sn_cf_blocked_countries").trigger("change")})),$("#sn_cf").on("click",".testresults h3",(function(e){e.preventDefault(),$(this).parents(".testresults").toggleClass("opened").find("table")})),$("#wf_sn_cf_blocked_countries").select2({multiple:!0,dropdownAutoWidth:!0,closeOnSelect:!1,theme:"classic"}),$("#sn-enable-firewall-overlay").on("click",(function(e){e.preventDefault(),$("#sn-firewall-modal").show()})),$(".sn-modal-close").on("click",(function(){$("#sn-firewall-modal").hide()})),$(document).on("click",(function(e){$(e.target).is("#sn-firewall-modal")&&$("#sn-firewall-modal").hide()})),$("#sn-modal-continue").on("click",(function(){var e={action:"sn_send_unblock_email",email:$("#sn-firewall-email").val(),_ajax_nonce:wf_sn_cf.nonce};$("#sn-modal-continue").attr("disabled","disabled"),$("#sn-firewall-email").attr("disabled","disabled"),$("#sn-unblock-message").html('<img title="Loading ..." src="'+wf_sn.sn_plugin_url+'images/ajax-loader.gif" alt="Loading...">'),$("#sn-unblock-message").removeClass("sn-unblock-message-bad"),$("#sn-unblock-message").removeClass("sn-unblock-message-good"),$.ajax({type:"POST",url:ajaxurl,data:e,success:function(e){$("#sn-firewall-status").text("Unblock email sent successfully. Enabling firewall..."),$.ajax({type:"POST",url:ajaxurl,data:{action:"sn_enable_firewall",_ajax_nonce:wf_sn_cf.nonce},success:function(e){$("#sn-unblock-message").hide(),$("#sn-firewall-status").text("Firewall enabled successfully. Reloading..."),setTimeout((function(){window.location.reload()}),2e3)},error:function(e,n,s){console.error("AJAX Error:",n,s),console.error("Response:",e.responseText),$("#sn-unblock-message").html("An error occurred. The firewall could not be enabled."),$("#sn-unblock-message").addClass("sn-unblock-message-bad"),$("#sn-modal-continue").removeAttr("disabled"),$("#sn-firewall-email").removeAttr("disabled")}})},error:function(e,n,s){console.error("AJAX Error:",n,s),console.error("Response:",e.responseText),$("#sn-unblock-message").html("An error occurred while sending the unblock email."),$("#sn-unblock-message").addClass("sn-unblock-message-bad"),$("#sn-modal-continue").removeAttr("disabled"),$("#sn-firewall-email").removeAttr("disabled")}})})),$("#sn-close-firewall").on("click",(function(e){e.preventDefault(),window.location.reload()})),$("#sn-send-unlock-code").on("click",(function(e){e.preventDefault();var n={action:"sn_send_unblock_email",email:$("#sn-ublock-email").val(),_ajax_nonce:wf_sn_cf.nonce};$("#sn-unblock-message").html('<img title="Loading ..." src="'+wf_sn.sn_plugin_url+'images/ajax-loader.gif" alt="Loading...">'),$("#sn-unblock-message").removeClass("sn-unblock-message-bad"),$("#sn-unblock-message").removeClass("sn-unblock-message-good"),$.get(ajaxurl,n,(function(e){"1"!==e?($("#sn-unblock-message").html("An error occurred and the message could not be sent."),$("#sn-unblock-message").addClass("sn-unblock-message-bad")):($("#sn-unblock-message").html("Email sent successfully."),$("#sn-unblock-message").addClass("sn-unblock-message-good"))}),"html").fail((function(){$("#sn-unblock-message").html("An error occurred. The email could not be sent."),$("#sn-unblock-message").addClass("sn-unblock-message-bad")}))})),$("#sn-firewall-blacklist-clear").on("click",(function(e){e.preventDefault();var n={action:"sn_clear_blacklist",email:$("#sn-ublock-email").val(),_ajax_nonce:wf_sn_cf.nonce};$("#sn-firewall-blacklist-clear").remove(),$("#sn-firewall-blacklist").append('<img title="Loading ..." src="'+wf_sn.sn_plugin_url+'images/ajax-loader.gif" alt="Loading...">'),$.get(ajaxurl,n,(function(e){"1"!==e?(alert("Undocumented error. Page will automatically reload."),window.location.reload()):(alert("List has been cleared."),$("#sn-firewall-blacklist").html("No locally banned IPs"))}),"html").fail((function(){alert("Undocumented error. Page will automatically reload."),window.location.reload()}))})),$("#sn-disable-firewall").on("click",(function(){$("#wf_sn_cf_active").val(0),$("#sn-firewall-settings-form").submit()})),$("#wf-cf-do-test-ip").on("click",(function(e){e.preventDefault();var n={action:"sn_test_ip",ip:$("#wf-cf-ip-test").val(),_ajax_nonce:wf_sn_cf.nonce};$.post(ajaxurl,n,(function(e){e.data&&e.success?alert(e.data):(alert("An undocumented error has occurred. Page will automatically reload."),window.location.reload())}),"json")}))}));