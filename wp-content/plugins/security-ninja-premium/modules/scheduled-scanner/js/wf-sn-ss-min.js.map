{"version":3,"sources":["wf-sn-ss.js"],"names":["jQuery","document","ready","$","on","confirm","data","action","_ajax_nonce","wf_sn","nonce_run_tests","sn_block_ui","post","ajaxurl","response","window","console","log","alert","location","reload","row_id","this","attr","timestamp","html","dialog","title","dialogClass","modal","resizable","zIndex","width","height","hide","show","autoOpen","closeOnEscape"],"mappings":"aAOCA,OAAOC,UAAUC,OAAM,SAASC,GAE/BA,EAAE,eAAeC,GAAG,SAAS,WAC3B,GAAKC,QAAQ,mEAAb,CAGA,IAAIC,EAAO,CACTC,OAAQ,gBACRC,YAAeC,MAAMC,iBAGvBC,YAAY,yBAEZR,EAAES,KAAKC,QAASP,GAAM,SAASQ,GAC7BC,OAAOC,QAAQC,IAAIH,GACH,KAAZA,GACFI,MAAM,uDACNH,OAAOI,SAASC,UAEhBL,OAAOI,SAASC,gBAMtBjB,EAAE,0BAA0BC,GAAG,SAAS,WAEtC,GADaC,QAAQ,oDACT,CAEVF,EAAES,KAAKC,QADI,CAACN,OAAQ,uBACE,SAASO,GACxBA,EAGHC,OAAOI,SAASC,SAFhBF,MAAM,iDAMZ,OAAO,KAITf,EAAE,kBAAkBC,GAAG,SAAS,WAC9B,IAAIE,EAAO,CAACC,OAAQ,mBAAoBc,OAAQlB,EAAEmB,MAAMC,KAAK,gBACzDC,EAAYrB,EAAEmB,MAAMC,KAAK,kBAW7B,OATApB,EAAES,KAAKC,QAASP,GAAM,SAASQ,GACxBA,EAGHX,EAAE,iBAAiBsB,KAAKX,GACvBY,OAAO,CAAEC,MAAO,+BAAiCH,IACjDE,OAAO,QAJRR,MAAM,kDAOH,KAOTf,EAAE,kBAAkBC,GAAG,SAAS,WAC9B,IAAIE,EAAO,CACTC,OAAQ,mBACRc,OAAQlB,EAAEmB,MAAMC,KAAK,gBAEnBC,EAAYrB,EAAEmB,MAAMC,KAAK,kBAa7B,OAXApB,EAAES,KAAKC,QAASP,GAAM,SAASQ,GACxBA,EAGHX,EAAE,iBAAiBsB,KAAKX,GACvBY,OAAO,CACNC,MAAO,6BAA+BH,IAEvCE,OAAO,QANRR,MAAM,kDASH,KAQTf,EAAE,iBAAiBuB,OAAO,CACxBE,YAAe,YACfC,OAAS,EACTC,WAAa,EACbC,OAAU,KACVC,MAAS,IACTC,OAAU,MACVC,KAAQ,OACRC,KAAQ,OACRC,UAAY,EACZC,eAAiB","sourcesContent":["/* globals jQuery:true, ajaxurl:true, wf_sn:true, sn_block_ui:true */\r\n/*\r\n * Security Ninja - Scheduled Scanner add-on\r\n * (c) Web factory 2015\r\n * Updated 2020 - Larsik Corp\r\n */\r\n\r\n jQuery(document).ready(function($){\r\n  // run tests, via ajax\r\n  $('#sn-ss-test').on('click', function(){\r\n    if (!confirm('Please remember to save settings before testing them. Continue?')) {\r\n      return;\r\n    }\r\n    var data = {\r\n      action: 'sn_ss_cs_test',\r\n      '_ajax_nonce': wf_sn.nonce_run_tests\r\n    };\r\n\r\n    sn_block_ui('#sn-scheduled-scanner');\r\n\r\n    $.post(ajaxurl, data, function(response) {\r\n      window.console.log(response);\r\n      if (response != '1') {\r\n        alert('Undocumented error. Page will automatically reload.');\r\n        window.location.reload();\r\n      } else {\r\n        window.location.reload();\r\n      }\r\n    });\r\n  }); // run tests\r\n\r\n  // truncate log table\r\n  $('#wf-sn-ss-truncate-log').on('click', function(){\r\n    var answer = confirm(\"Are you sure you want to delete all log entries?\");\r\n    if (answer) {\r\n      var data = {action: 'sn_ss_truncate_log'};\r\n      $.post(ajaxurl, data, function(response) {\r\n        if (!response) {\r\n          alert('Bad AJAX response. Please reload the page.');\r\n        } else {\r\n          window.location.reload();\r\n        }\r\n      });\r\n    }\r\n    return false;\r\n  });\r\n\r\n  // security ninja results details\r\n  $('.ss-details-sn').on('click', function(){\r\n    var data = {action: 'sn_ss_sn_details', row_id: $(this).attr('data-row-id') };\r\n    var timestamp = $(this).attr('data-timestamp');\r\n\r\n    $.post(ajaxurl, data, function(response) {\r\n      if (!response) {\r\n        alert('Bad AJAX response. Please reload the page.');\r\n      } else {\r\n        $('#wf-ss-dialog').html(response)\r\n        .dialog({ title: 'Security Ninja results from ' + timestamp })\r\n        .dialog('open');\r\n      }\r\n    });\r\n    return false;\r\n  });\r\n\r\n\r\n\r\n\r\n  // cores canner results details\r\n  $('.ss-details-cs').on('click', function(){\r\n    var data = {\r\n      action: 'sn_ss_cs_details',\r\n      row_id: $(this).attr('data-row-id')\r\n    };\r\n    var timestamp = $(this).attr('data-timestamp');\r\n\r\n    $.post(ajaxurl, data, function(response) {\r\n      if (!response) {\r\n        alert('Bad AJAX response. Please reload the page.');\r\n      } else {\r\n        $('#wf-ss-dialog').html(response)\r\n        .dialog({ \r\n          title: 'Core Scanner results from ' + timestamp \r\n        })\r\n        .dialog('open');\r\n      }\r\n    });\r\n    return false;\r\n  });\r\n\r\n\r\n\r\n\r\n\r\n  // prepare dialog\r\n  $('#wf-ss-dialog').dialog({\r\n    'dialogClass': 'wp-dialog',\r\n    'modal': true,\r\n    'resizable': true,\r\n    'zIndex': 9999,\r\n    'width': 900,\r\n    'height': '550',\r\n    'hide': 'fade',\r\n    'show': 'fade',\r\n    'autoOpen': false,\r\n    'closeOnEscape': true\r\n  });\r\n\r\n});"]}